## 2.1 Tauri 入口的可持续性策略

- 责任边界：Tauri 入口 wiring 与运行期装配策略。
- 不负责：业务用例逻辑与持久化实现细节。
- 目录映射：`src-tauri/src/`（`main.rs`、`lib.rs`、`app/`、`commands/`）。
- 交付物：入口层职责边界与演进策略。
- 验收指标：入口层变更影响面可控、装配清晰度。

目标是让入口层“稳定、可控、可演进”，优先保证安全边界与职责边界清晰。

已落实（方案 A）：

- 数据库池选择抽离为单一职责模块（`src-tauri/src/app/db.rs`），避免在入口层混合配置解析与资源选择。
- SQLite 连接池查找由“假设必定存在”改为“显式判定 + 错误返回”，降低隐藏 panic 风险。
- `capabilities` 移除 `sql:allow-execute`，推动 SQL 访问通过后端命令封装。
- CSP 不再禁用，提供最小可用策略作为安全基线。
- 窗口全屏事件同步逻辑封装为私有结构体，减少局部状态散落。

规划中（方案 C）：

- 引入 `AppContext` 统一管理 services/router/db 等共享资源，减少 `run()` 内聚合。
- 以 provider/registrar 形式注册窗口事件与插件初始化，确保扩展时变更隔离。
- 为未来多窗口、多数据库或多入口场景提供明确扩展点。
